[gd_scene load_steps=16 format=4 uid="uid://c3gribds53xao"]

[ext_resource type="PackedScene" uid="uid://bh8jf4ley7tw5" path="res://tilemaps/ground.tscn" id="1_4u2iw"]
[ext_resource type="PackedScene" uid="uid://bxl2ccdf31g4r" path="res://head.tscn" id="2_n5jds"]
[ext_resource type="PackedScene" uid="uid://c74k00wdcpco0" path="res://chicken.tscn" id="3_mee7w"]
[ext_resource type="Texture2D" uid="uid://boqtaexxcfoki" path="res://assets/finalebackground/Untitled401_20240819112536.png" id="4_3j1x8"]
[ext_resource type="Texture2D" uid="uid://d102a13un08om" path="res://assets/finalebackground/fullrocka.png" id="5_ae04b"]
[ext_resource type="Texture2D" uid="uid://c0x4u7vfw8bwh" path="res://assets/finalebackground/Untitled401_20240819114122.png" id="6_5uqa2"]
[ext_resource type="PackedScene" uid="uid://q8v6usd1wdl" path="res://levels/body.tscn" id="7_4qptk"]

[sub_resource type="GDScript" id="GDScript_dkuy3"]
script/source = "extends Camera2D


@export var target : Node2D
@export var bg : Node2D
var campos :float = 0
var z :float =1
var ended = false

func _end():
	ended = true
	target.queue_free()
	get_parent().get_node(\"TileMap\").hide()
	campos = 0

func _physics_process(delta: float) -> void:
	if(ended):
		zoom = Vector2(1,1)
		position = Vector2(0,0)
		return
	ScenesManger.music.volume_db -= 0.09
	if(target.get_head_pos().x >= campos + (1270 - 300)):
		campos = target.get_head_pos().x
		z -= 0.01
	if(target.get_head_pos().x > 3900):
		get_parent().get_node(\"AnimationPlayer\").play(\"finale\")
	#elif(target.get_head_pos().x <= campos + 300):
		#campos = target.get_head_pos().x - 1270 / 2
	
	#print(target.get_head_pos())
	
	bg.position.x = lerp(0.0,-597.0,position.x / 3820.0)
	
	zoom = lerp(zoom,Vector2(z,z),0.02)
	position.x = lerp(position.x,max(0.0,campos),0.01)
		
"

[sub_resource type="Shader" id="Shader_6fopd"]
code = "shader_type canvas_item;

uniform sampler2D SCREEN_TEXTURE : hint_screen_texture,filter_linear_mipmap,repeat_enable;
uniform sampler2D noise : repeat_enable;

void vertex() {
	// Called for every vertex the material is visible on.
}

void fragment() {
	float off = texture(noise,UV + vec2(TIME/300.0,TIME/30.0)).r;
	vec4 clr = texture(SCREEN_TEXTURE,vec2(SCREEN_UV.x + off / 1000.0,1.-SCREEN_UV.y + 0.25 - off / 20.0 + 0.2));
	COLOR.rgb = clr.rgb;
}

//void light() {
	// Called for every pixel for every light affecting the CanvasItem.
	// Uncomment to replace the default light processing function with this one.
//}
"

[sub_resource type="FastNoiseLite" id="FastNoiseLite_xyvam"]

[sub_resource type="NoiseTexture2D" id="NoiseTexture2D_nk7bd"]
seamless = true
noise = SubResource("FastNoiseLite_xyvam")

[sub_resource type="ShaderMaterial" id="ShaderMaterial_jvycc"]
shader = SubResource("Shader_6fopd")
shader_parameter/noise = SubResource("NoiseTexture2D_nk7bd")

[sub_resource type="Animation" id="Animation_e64x6"]
length = 0.001
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("CanvasLayer/ColorRect:color")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 0,
"values": [Color(0, 0, 0, 0)]
}
tracks/1/type = "value"
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/path = NodePath("Node2D:position")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 0,
"values": [Vector2(526, 859)]
}

[sub_resource type="Animation" id="Animation_bi4rc"]
resource_name = "finale"
length = 10.0
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("CanvasLayer/ColorRect:color")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 1, 2),
"transitions": PackedFloat32Array(1, 2.46229, 1),
"update": 0,
"values": [Color(0, 0, 0, 0.988235), Color(0, 0, 0, 0.988235), Color(0, 0, 0, 0)]
}
tracks/1/type = "method"
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/path = NodePath("Camera2D")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/keys = {
"times": PackedFloat32Array(0.0333333),
"transitions": PackedFloat32Array(1),
"values": [{
"args": [],
"method": &"_end"
}]
}
tracks/2/type = "value"
tracks/2/imported = false
tracks/2/enabled = true
tracks/2/path = NodePath("Node2D:position")
tracks/2/interp = 1
tracks/2/loop_wrap = true
tracks/2/keys = {
"times": PackedFloat32Array(0, 3, 4.73333, 6.43333, 8.43333),
"transitions": PackedFloat32Array(1, -1.68179, 1, 3.36359, 1),
"update": 0,
"values": [Vector2(526, 859), Vector2(526, 859), Vector2(526, 269), Vector2(528, 259), Vector2(1150, -627)]
}

[sub_resource type="AnimationLibrary" id="AnimationLibrary_avy5a"]
_data = {
"RESET": SubResource("Animation_e64x6"),
"finale": SubResource("Animation_bi4rc")
}

[node name="notherone" type="Node2D"]

[node name="TileMap" type="TileMap" parent="."]
format = 2

[node name="ground" parent="TileMap" instance=ExtResource("1_4u2iw")]
tile_map_data = PackedByteArray("AAAAAA4AAAABAAIAAAAAAA8AAAACAAEAAAAAABAAAAAAAAIAAAAAABEAAAACAAEAAAABAA4AAAABAAEAAAABAA8AAAAAAAAAAAABABAAAAAAAAAAAAABABEAAAAAAAAAAAACAA4AAAACAAAAAAACAA8AAAAAAAAAAAACABAAAAAAAAAAAAACABEAAAAAAAAAAAADAA4AAAACAAAAAAADAA8AAAAAAAAAAAADABAAAAAAAAAAAAADABEAAAAAAAAAAAAEAA4AAAAAAAEAAAAEAA8AAAAAAAAAAAAEABAAAAAAAAAAAAAEABEAAAAAAAAAAAAFAA4AAAABAAEAAAAFAA8AAAAAAAAAAAAFABAAAAAAAAAAAAAFABEAAAAAAAAAAAAGAA4AAAACAAAAAAAGAA8AAAAAAAAAAAAGABAAAAAAAAAAAAAGABEAAAAAAAAAAAAHAA4AAAAAAAEAAAAHAA8AAAAAAAAAAAAHABAAAAAAAAAAAAAHABEAAAAAAAAAAAAIAA4AAAABAAEAAAAIAA8AAAAAAAAAAAAIABAAAAAAAAAAAAAIABEAAAAAAAAAAAAJAA4AAAAAAAEAAAAJAA8AAAAAAAAAAAAJABAAAAAAAAAAAAAJABEAAAAAAAAAAAAKAA4AAAAAAAEAAAAKAA8AAAAAAAAAAAAKABAAAAAAAAAAAAAKABEAAAAAAAAAAAALAA4AAAACAAAAAAALAA8AAAAAAAAAAAALABAAAAAAAAAAAAALABEAAAAAAAAAAAAMAA4AAAABAAEAAAAMAA8AAAAAAAAAAAAMABAAAAAAAAAAAAAMABEAAAAAAAAAAAANAA4AAAAAAAEAAAANAA8AAAAAAAAAAAANABAAAAAAAAAAAAANABEAAAAAAAAAAAAOAA4AAAABAAAAAAAOAA8AAAAAAAAAAAAOABAAAAAAAAAAAAAOABEAAAAAAAAAAAAPAA4AAAABAAAAAAAPAA8AAAAAAAAAAAAPABAAAAAAAAAAAAAPABEAAAAAAAAAAAAYAAwAAQAAAAAAAAAQAA4AAAACAAAAAAAQAA8AAAAAAAAAAAAQABAAAAAAAAAAAAAQABEAAAAAAAAAAAARAA4AAAABAAIAABARAA8AAAACAAEAABARABAAAAAAAAIAABARABEAAAAAAAIAABAgAAsAAQAAAAAAAAAoAAoAAQAAAAAAAAAwAAoAAQAAAAAAAAA4AAoAAQAAAAAAAAA+AAoAAQAAAAAAAABCAAoAAQAAAAAAAABGAAoAAQAAAAAAAABKAAoAAQAAAAAAAABNAAoAAQAAAAAAAABQAAoAAQAAAAAAAABTAAoAAAABAAIAAABUAAoAAAACAAAAAABVAAoAAAABAAEAAABWAAoAAAABAAEAAABXAAoAAAAAAAEAAABYAAoAAAABAAEAAABZAAoAAAABAAEAAABaAAoAAAABAAAAAABbAAoAAAABAAEAAABcAAoAAAABAAAAAABdAAoAAAABAAEAAABeAAoAAAACAAAAAABfAAoAAAABAAIAABA=")

[node name="chicken" type="Node2D" parent="TileMap"]

[node name="Chicken" parent="TileMap/chicken" instance=ExtResource("3_mee7w")]
position = Vector2(980, 462)
dir = 0
moves = false

[node name="Chicken2" parent="TileMap/chicken" instance=ExtResource("3_mee7w")]
position = Vector2(1299, 420)
dir = 0
moves = false

[node name="Chicken3" parent="TileMap/chicken" instance=ExtResource("3_mee7w")]
position = Vector2(1620, 382)
moves = false

[node name="Chicken4" parent="TileMap/chicken" instance=ExtResource("3_mee7w")]
position = Vector2(1940, 382)
moves = false

[node name="Chicken5" parent="TileMap/chicken" instance=ExtResource("3_mee7w")]
position = Vector2(2260, 382)
moves = false

[node name="Chicken6" parent="TileMap/chicken" instance=ExtResource("3_mee7w")]
position = Vector2(2500, 382)
moves = false

[node name="Chicken7" parent="TileMap/chicken" instance=ExtResource("3_mee7w")]
position = Vector2(2660, 382)
moves = false

[node name="Chicken8" parent="TileMap/chicken" instance=ExtResource("3_mee7w")]
position = Vector2(2820, 382)
moves = false

[node name="Chicken9" parent="TileMap/chicken" instance=ExtResource("3_mee7w")]
position = Vector2(2980, 382)
moves = false

[node name="Chicken10" parent="TileMap/chicken" instance=ExtResource("3_mee7w")]
position = Vector2(3100, 382)
moves = false

[node name="Chicken11" parent="TileMap/chicken" instance=ExtResource("3_mee7w")]
position = Vector2(3220, 382)
moves = false

[node name="Chicken12" parent="TileMap/chicken" instance=ExtResource("3_mee7w")]
position = Vector2(3340, 382)
moves = false

[node name="Chicken13" parent="TileMap/chicken" instance=ExtResource("3_mee7w")]
position = Vector2(3380, 382)
moves = false

[node name="Chicken14" parent="TileMap/chicken" instance=ExtResource("3_mee7w")]
position = Vector2(3420, 382)
moves = false

[node name="Chicken15" parent="TileMap/chicken" instance=ExtResource("3_mee7w")]
position = Vector2(3460, 382)
moves = false

[node name="Chicken16" parent="TileMap/chicken" instance=ExtResource("3_mee7w")]
position = Vector2(3500, 382)
moves = false

[node name="Chicken17" parent="TileMap/chicken" instance=ExtResource("3_mee7w")]
position = Vector2(3540, 382)
moves = false

[node name="Chicken18" parent="TileMap/chicken" instance=ExtResource("3_mee7w")]
position = Vector2(3580, 382)
moves = false

[node name="Chicken19" parent="TileMap/chicken" instance=ExtResource("3_mee7w")]
position = Vector2(3620, 382)
moves = false

[node name="Chicken20" parent="TileMap/chicken" instance=ExtResource("3_mee7w")]
position = Vector2(3660, 382)
moves = false

[node name="Chicken21" parent="TileMap/chicken" instance=ExtResource("3_mee7w")]
position = Vector2(3700, 382)
moves = false

[node name="Chicken22" parent="TileMap/chicken" instance=ExtResource("3_mee7w")]
position = Vector2(3740, 382)
moves = false

[node name="Chicken23" parent="TileMap/chicken" instance=ExtResource("3_mee7w")]
position = Vector2(3780, 382)
moves = false

[node name="Chicken24" parent="TileMap/chicken" instance=ExtResource("3_mee7w")]
position = Vector2(3820, 382)
moves = false

[node name="head" parent="." instance=ExtResource("2_n5jds")]
position = Vector2(20, 525)
length = 9

[node name="Camera2D" type="Camera2D" parent="." node_paths=PackedStringArray("target", "bg")]
anchor_mode = 0
script = SubResource("GDScript_dkuy3")
target = NodePath("../head")
bg = NodePath("../CanvasLayer/Node2D")

[node name="CanvasLayer" type="CanvasLayer" parent="."]
layer = -94

[node name="Node2D" type="Node2D" parent="CanvasLayer"]

[node name="Untitled40120240819112536" type="Sprite2D" parent="CanvasLayer/Node2D"]
scale = Vector2(1.985, 1.985)
texture = ExtResource("4_3j1x8")
centered = false

[node name="Fullrocka" type="Sprite2D" parent="CanvasLayer/Node2D"]
visible = false
scale = Vector2(1.985, 1.985)
texture = ExtResource("5_ae04b")
centered = false

[node name="ColorRect" type="ColorRect" parent="CanvasLayer/Node2D/Fullrocka"]
offset_right = 1910.0
offset_bottom = 716.0
color = Color(1, 1, 1, 0.203922)
metadata/_edit_use_anchors_ = true

[node name="Untitled40120240819114122" type="Sprite2D" parent="CanvasLayer/Node2D"]
modulate = Color(1, 1, 1, 0.643137)
material = SubResource("ShaderMaterial_jvycc")
scale = Vector2(1.985, 1.985)
texture = ExtResource("6_5uqa2")
centered = false

[node name="ColorRect" type="ColorRect" parent="CanvasLayer"]
offset_left = -8.0
offset_top = -18.0
offset_right = 1306.0
offset_bottom = 748.0
color = Color(0, 0, 0, 0)

[node name="AnimationPlayer" type="AnimationPlayer" parent="."]
libraries = {
"": SubResource("AnimationLibrary_avy5a")
}
speed_scale = 0.5

[node name="Node2D" parent="." instance=ExtResource("7_4qptk")]
position = Vector2(526, 859)
scale = Vector2(1.34951, 1.34951)
